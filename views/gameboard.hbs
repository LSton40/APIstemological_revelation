<!DOCTYPE html>
<html lang="en">



<div id="gameDiv"></div>

<body>


    <script src="https://pixijs.download/release/pixi.js"></script>

    <script>

        let app;
        const NORMAL = 0xFFFFFF;
        const OVER = 0x00FF00;
        const DOWN = 0xFF0000;
        const RECT_W = 100;
        const RECT_H = 100;
        let offsetX = 650;
        let offsetY = 100;
        let spacing = 0;
        let pegHoles = [];
        let pointerIsDown = false;
        let pointerIsOver = false;
        let color = NORMAL;
        let startingX = 0;
        let startingY = 0;
        let radius = 15;
        let posTracker = 0;
        const PEG_HOLE_SPACING = 10;
        let gameContainer;

        window.onload = function () {
            app = new PIXI.Application({
                width: window.innerWidth,
                height: window.innerHeight / 1.5,
                backgroundColor: 0xAAAAAA

            });
            document.querySelector('#gameDiv').appendChild(app.view);
            gameContainer = new PIXI.Container();
            app.stage.addChild(gameContainer);


            //beginning of game drawing
            // Top column // peg hole 0 - 18
            for (let i = 0; i < 19; i++) {

                const x = startingX + 2 * radius * i;
                const y = startingY;

                pegHoles.push(new PegHole((x + offsetX), y + offsetY, radius, color, "hole " + posTracker++));
            };

            // Right column // peg holes 19 - 35
            for (let i = 0; i < 17; i++) {

                const x = startingX + 36 * radius;
                const y = startingY + 2 * radius + 2 * radius * i;

                pegHoles.push(new PegHole(x + offsetX + (spacing * 11), y + offsetY + spacing, radius, color, "hole " + posTracker++));
            };
            // Bottom row // peg holes 36 - 54
            for (let i = 0; i < 19; i++) {

                const x = startingX + 36 * radius - 2 * radius * i;
                const y = startingY + 2 * radius + 34 * radius;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };
            // Left column // peg holes 55 - 71
            for (let i = 0; i < 17; i++) {

                const x = startingX;
                const y = startingY + 34 * radius - 2 * radius * i;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };
            // Top finish line // peg holes 72 - 76
            for (let i = 0; i < 3; i++) {

                const x = startingX + 6 * radius;
                const y = startingY + 2 * radius + 2 * radius * i;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };
            for (let i = 0; i < 2; i++) {

                const x = startingX + 8 * radius + 2 * radius * i;
                const y = startingY + 6 * radius;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };
            // Bottom finish line // peg holes 77 - 81
            for (let i = 0; i < 3; i++) {

                const x = startingX + 30 * radius;
                const y = startingY + 30 * radius + 2 * radius * i;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            }
            for (let i = 0; i < 2; i++) {

                const x = startingX + 26 * radius + 2 * radius * i;
                const y = startingY + 30 * radius;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };
            // Right finish line // peg holes 82 - 86
            for (let i = 0; i < 3; i++) {

                const x = startingX + 30 * radius + 2 * radius * i;
                const y = startingY + 6 * radius;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };
            for (let i = 0; i < 2; i++) {

                const x = startingX + 30 * radius;
                const y = startingY + 8 * radius + 2 * radius * i;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };
            // Left finish line // peg holes 87 - 91
            for (let i = 0; i < 3; i++) {

                const x = startingX + 2 * radius + 2 * radius * i;
                const y = startingY + 30 * radius;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };
            for (let i = 0; i < 2; i++) {

                const x = startingX + 6 * radius;
                const y = startingY + 26 * radius + 2 * radius * i;

                pegHoles.push(new PegHole(x + offsetX, y + offsetY, radius, color, "hole " + posTracker++));
            };

            //end of game drawing
            //needs a parent square to hold pegs

            for (let i = 0; i < pegHoles.length; i++) {
                gameContainer.addChild(pegHoles[i]);
            }
            console.log(pegHoles);

            app.ticker.add(gameLoop);

            test();

        }

        function gameLoop(delta) { }


        function PegHole(x, y, radius, color, name, speed) {
            let circle = new PIXI.Graphics();
            circle.beginFill(NORMAL);
            circle.drawCircle(x, y, radius, radius);
            circle.endFill();
            circle.interactive = true;
            circle.buttonMode = true;

            circle.on("pointerup", doPointerUp);
            circle.on("pointerdown", doPointerDown);
            circle.on("pointerover", doPointerOver);
            circle.on("pointerout", doPointerOut);
            circle.on("pointerupoutside", doPointerUpOutside);


            circle.name = name;
            circle.speed = speed;

            return circle;
        }






        function doPointerUp() {
            console.log("pointer up");
            // this.beginFill(NORMAL);
            // // this.drawRect((app.view.width / 2) - 100, (app.view.height / 2) - 100, 200, 200);
            // this.endFill();
            if (pointerIsOver) {
                this.tint = NORMAL;
                // this.y = this.y - this.speed;
                console.log(`${this.name} is up at ${this.y}`);
            }
            else {
                this.tint = NORMAL
            }
            pointerIsDown = false;
        }
        function doPointerDown() {
            pegHoles[69].tint = '0xF78DA7';
            pegHoles[77].tint = '0xF78DA7';
            pegHoles[89].tint = '0xF78DA7';


            console.log("pointer down");
            // this.beginFill(DOWN);
            // // this.drawRect((app.view.width / 2) - 100, (app.view.height / 2) - 100, 200, 200);
            // this.endFill();
            this.tint = DOWN;
            pointerIsDown = true;
            let name = this.name;
            console.log('name is being passed');
            let test = socket.emit('tile-press', name);
            console.log(`test: ${test}`);
            //console.log(`name = > ${name}`)
            console.log('name has passed');

        }
        function doPointerOver() {
            console.log("pointer over");
            // this.beginFill(OVER);
            // // this.drawRect((app.view.width / 2) - 100, (app.view.height / 2) - 100, 200, 200);
            // this.endFill();
            this.tint = OVER;
            pointerIsOver = true;
        }
        function doPointerOut() {
            console.log("pointer out");
            // this.beginFill(NORMAL);
            // this.drawRect((app.view.width / 2) - 100, (app.view.height / 2) - 100, 200, 200);
            // this.endFill();
            this.tint = NORMAL;
        }
        function doPointerUpOutside() {
            console.log("pointer up outside");
            // this.beginFill(NORMAL);
            // this.drawRect((app.view.width / 2) - 100, (app.view.height / 2) - 100, 200, 200);
            // this.endFill();
            this.tint = NORMAL;
            pointerIsOver = false;
            pointerIsDown = false;
        }

        function test(){
            console.log('rewrwrwerwer');
        }









    </script>




</body>

</html>